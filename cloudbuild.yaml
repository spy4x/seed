steps:

# Checkout origin master for "Nx Affected" commands
#  - name: git
#    args: [fetch --no-tags --prune --depth=5 origin master]


  - name: gcr.io/cloud-builders/git
    entrypoint: git
    args: [
      fetch --no-tags --prune --depth=5 origin master
    ]

  - name: node
    entrypoint: npm
    args: [
      install
    ]

# Install dependencies
  - name: node
    entrypoint: yarn
    args: ['install --frozen-lockfile']
    id: deps

# Check formatting
  - name: node
    entrypoint: yarn
    args: ['ci:format']
    waitFor: [deps]


# Lint
  - name: node
    entrypoint: yarn
    args: [ci:lint]
    waitFor: [deps]
